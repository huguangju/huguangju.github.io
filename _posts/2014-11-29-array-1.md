---
layout: post
title: java基础最佳实践系列——Array(一)
description: "http://www.leveluplunch.com/java/examples/ java基础示例系列中文版"
category: [blog, java, examples]
tags : [java, 示例, 翻译]
duoshuo: false
---

[返回总目录]({% post_url 2014-11-29-java-base-examples %})<br/>
[Array(二)]({% post_url 2014-11-30-array-2 %})

## 计算平均值
Similar to finding the average of an arraylist or collection, this example will use java, java 8, guava and apache commons to demonstrate how to find the average or the arithmetic mean of a numeric array of a primitive type.

### Setup
<pre class='brush: java'>
double[] NUMBERS = {1, 24, 45, 62, 85, 8, 91, 3, 5, 56, 9};
</pre>
<!-- more -->

### Straight up Java
Using a standard java technique, we will iterate over the numbers array using a ```for each loop```. Each iteration will add to the total and then divide by the array length, thus finding the average.

<pre class='brush: java'>
@Test
public void calculate_average_of_array_java () {

    double total = 0;
    for (double element : NUMBERS) {
        total += element;
    }

    double average = total / NUMBERS.length;

    assertEquals(35.36363636363637, average, 0);
}
</pre>

### Java 8
In java 8, the JDK provides a series of ```reduction operations``` which provides an internal implementation. Unlike the example above, this abstraction enables a cleaner, more maintainable, and eloquent of way of handling finding the average of the array. If you choose, stream.parallel will enable the internal implementation to choose to perform the reduce operation in parallel. Looking for more than just the average, DoubleSummaryStatistics is a class that calculates all statistics such as average, count, min max and sum.

<pre class='brush: java'>
@Test
public void calculate_average_of_array_java8 () {

    OptionalDouble average = Arrays.stream(NUMBERS).average();

    assertEquals(35.36363636363637, average.getAsDouble(), 0);
}
</pre>

### Google Guava
Guava provides a class for arithmetic on doubles that is not covered by java.lang.Math.

<pre class='brush: java'>
@Test
public void calculate_average_of_array_guava () {

    double average = DoubleMath.mean(NUMBERS);

    assertEquals(35.36363636363637, average, 0);
}
</pre>

### Apache Commons
Apache commons Mean class will computes the arithmetic mean of a set of double values.

<pre class='brush: java'>
@Test
public void calculate_average_of_array_apache () {

    Mean mean = new Mean();
    double average = mean.evaluate(NUMBERS);

    assertEquals(35.36363636363637, average, 0);
}
</pre>

---

## Collection转Array
In contrast to converting an array to list, this example will convert a collection to an array while using java 8, guava and apache libraries.

### Straight up Java

#### Objects

<pre class='brush: java'>
@Test
public void convert_collection_of_strings_to_array_with_java () {

    List<String> searchEnginesAsList = Lists.newArrayList(
        "Google", "Bing", "Yahoo", "Ask", "AOL");

    String[] searchEngines = searchEnginesAsList
        .toArray(new String[searchEnginesAsList.size()]);

    logger.info(Arrays.toString(searchEngines));

    assertEquals(5, searchEngines.length);

}
</pre>
Output

<pre class='brush: java'>
[Google, Bing, Yahoo, Ask, AOL]
</pre>

### Primitives

<pre class='brush: java'>
@Test
public void convert_collection_of_primitives_to_array_with_java () {

    List<Double> searchEngineMarketShare = Lists.newArrayList();
    searchEngineMarketShare.add(67.1);
    searchEngineMarketShare.add(16.9);
    searchEngineMarketShare.add(11.8);
    searchEngineMarketShare.add(2.7);
    searchEngineMarketShare.add(1.6);

    double [] searchEngineMarketShareArray = new double[searchEngineMarketShare.size()];
    for (int x=0; x <= searchEngineMarketShare.size() - 1; x ++) {
        searchEngineMarketShareArray[x] = searchEngineMarketShare.get(x);
    }

    logger.info(Arrays.toString(searchEngineMarketShareArray));

    assertEquals(5, searchEngineMarketShareArray.length);
}
</pre>
Output

<pre class='brush: java'>
[67.1, 16.9, 11.8, 2.7, 1.6]
</pre>

### Java 8
In java 8, a common operation of java.util.stream is to convert elements to a primitive stream of type Intstream, DoubleStream or LongStream which can accomplished by calling a specialized method stream.mapToInt, stream.mapToDouble and stream.mapToLong respectively. Here, the mapToDouble method is called that returns a DoubleStream and applies the Double.doubleValue to each element returning an array of doubles.

#### Primitives

<pre class='brush: java'>
@Test
public void convert_collection_of_primitives_to_array_with_java8 () {

    List<Double> searchEngineMarketShare = Lists.newArrayList();
    searchEngineMarketShare.add(67.1);
    searchEngineMarketShare.add(16.9);
    searchEngineMarketShare.add(11.8);
    searchEngineMarketShare.add(2.7);
    searchEngineMarketShare.add(1.6);

    double [] searchEngineMarketShareArray = searchEngineMarketShare
            .stream()
            .mapToDouble(Double::doubleValue)
            .toArray();

    logger.info(Arrays.toString(searchEngineMarketShareArray));

    assertEquals(5, searchEngineMarketShareArray.length);
}
</pre>
Output

<pre class='brush: java'>
[67.1, 16.9, 11.8, 2.7, 1.6]
</pre>

### Google Guava
Guava's Doubles class provides static utility methods that pertain to double primitives that are not already found in either Double or Arrays. By calling the Doubles.toArray we convert each value to a double and then return an array containing the values of searchEngineMarketShare.

#### Primitives

<pre class='brush: java'>
@Test
public void convert_collection_of_objects_to_primitive_array_with_guava () {

    List<Double> searchEngineMarketShare = Lists.newArrayList();
    searchEngineMarketShare.add(67.1);
    searchEngineMarketShare.add(16.9);
    searchEngineMarketShare.add(11.8);
    searchEngineMarketShare.add(2.7);
    searchEngineMarketShare.add(1.6);

    double[] searchEngineMarketShareArray = Doubles.toArray(searchEngineMarketShare);

    logger.info(Arrays.toString(searchEngineMarketShareArray));

    assertEquals(5, searchEngineMarketShareArray.length);

}
</pre>
Output

<pre class='brush: java'>
[67.1, 16.9, 11.8, 2.7, 1.6]
</pre>

### Apache Commons
Using apache commons we first convert the list to a Double array and then call ArrayUtils.toPrimitive to convert to a primitive array.

#### Primitives

<pre class='brush: java'>
@Test
public void convert_collection_of_objects_to_array_with_apachecommons () {

    List<Double> searchEngineMarketShare = Lists.newArrayList();
    searchEngineMarketShare.add(67.1);
    searchEngineMarketShare.add(16.9);
    searchEngineMarketShare.add(11.8);
    searchEngineMarketShare.add(2.7);
    searchEngineMarketShare.add(1.6);

    Double[] searchEngineMarketShareDoubleArray = searchEngineMarketShare
            .toArray(new Double[searchEngineMarketShare.size()]);

    double[] searchEngineMarketShareArray =
            ArrayUtils.toPrimitive(searchEngineMarketShareDoubleArray);

    logger.info(Arrays.toString(searchEngineMarketShareArray));

    assertEquals(5, searchEngineMarketShareArray.length);
}
</pre>
Output

<pre class='brush: java'>
[67.1, 16.9, 11.8, 2.7, 1.6]
</pre>

---

## 查找数组元素
In this example we will search for specified object in a given array while using java, guava and apache commons. Since we are huge fans of the Minnesota Vikings, not, we will highlight losings seasons and check if a specified value exists.

### Straight up Java
With straight up java, there are multiple ways to find an element in an array. We will first iterate over an array with a java 5 for each loop comparing each element to 1962. If 1962 is found, we will set the losingSeason boolean variable to false and proceed to break the loop.

#### Loop
<pre class='brush: java'>
@Test
public void search_array_java () {

    Integer[] vikQueensLosingSeasons = {
            1962, 1967, 1984, 2011, 1966,
            1963, 1982, 2001, 1990, 2002,
            2006, 2010, 1965, 1972, 1979,
            1981, 1985};

    boolean losingSeason = false;
    for (Integer number : vikQueensLosingSeasons) {
        if (number.equals(1962)) {
            losingSeason = true;
            break;
        }
    }

    assertTrue(losingSeason);
}
</pre>

#### List contains
Similar to how we find an element in a collection we will convert the array to a list and then call Lists.contains to check if the list contains the specified element.

<pre class='brush: java'>
@Test
public void search_array_java_with_list_contains_with_list_contains () {

    Integer[] vikQueensLosingSeasons = {
            1962, 1967, 1984, 2011, 1966,
            1963, 1982, 2001, 1990, 2002,
            2006, 2010, 1965, 1972, 1979,
            1981, 1985};

    boolean hadALosingSeason = Arrays
            .asList(vikQueensLosingSeasons)
            .contains(new Integer(1962));

    assertTrue(hadALosingSeason);
}
</pre>

#### Binary search
Another technique is to use Arrays.binarySearch to find an element in an array by using the binary search algorithm. When using this technique, you must sort array in ascending order according to the natural ordering of its elements.

<pre class='brush: java'>
@Test
public void array_contains_element_java_binary_search () {

    Integer[] vikQueensLosingSeasons = {
            1962, 1967, 1984, 2011, 1966,
            1963, 1982, 2001, 1990, 2002,
            2006, 2010, 1965, 1972, 1979,
            1981, 1985};

    Arrays.sort(vikQueensLosingSeasons);

    int elementPosition = Arrays.binarySearch(vikQueensLosingSeasons, 1962);

    assertTrue(elementPosition >= 0);
}
</pre>

#### Java 8
Using java 8 we will build a stream from an array using Arrays.stream, them filter the stream with criteria to find an element in an array. Next we will call the Stream.findAny method which will return an Optional describing the element if found otherwise an empty Optional if the stream is empty.

<pre class='brush: java'>
@Test
public void array_contains_element_java8 () {

    Integer[] vikQueensLosingSeasons = {
            1962, 1967, 1984, 2011, 1966,
            1963, 1982, 2001, 1990, 2002,
            2006, 2010, 1965, 1972, 1979,
            1981, 1985};

    java.util.Optional<Integer> yearExists =
            Arrays.stream(vikQueensLosingSeasons)
            .filter(p -> p == 1972)
            .findAny();

    assertTrue(yearExists.isPresent());
}
</pre>

### Google Guava

####Primitive contains
Ints is class in the guava library that contains a series of static methods pertaining to int primitives. In the example below, we will call Int.contains on the vikQueensLosingSeasons to verify that 1972 exists.

<pre class='brush: java'>
@Test
public void array_contains_element_java_with_guava () {

    int[] vikQueensLosingSeasons = {
            1962, 1967, 1984, 2011, 1966,
            1963, 1982, 2001, 1990, 2002,
            2006, 2010, 1965, 1972, 1979,
            1981, 1985};

    boolean yearExists = Ints.contains(vikQueensLosingSeasons, 1972);

    assertTrue(yearExists);
}
</pre>

Iterator.tryfind w/ predicate

Guava Iterables utilty class provides Iterables.tryFind method which returns a guava Optional class containing the first element in the array that satisified the given predicate. If an element doesn't exists it will return an empty Optional.

<pre class='brush: java'>
@Test
public void find_element_in_array_java_with_guava() {

    Integer[] vikQueensLosingSeasons = { 1962, 1967, 1984, 2011, 1966,
            1963, 1982, 2001, 1990, 2002, 2006, 2010, 1965, 1972, 1979,
            1981, 1985 };

    Optional<Integer> contains = Iterators.tryFind(
            Iterators.forArray(vikQueensLosingSeasons),
            new Predicate<Integer>() {

                public boolean apply(Integer input) {
                    if (input == 1962) {
                        return true;
                    } else {
                        return false;
                    }
                }
            });

    assertTrue(contains.isPresent());
    assertEquals(new Integer(1962), contains.get());
}
</pre>

### Apache Commons
Apache commons ArrayUtils class provides operations for dealing with primitive arrays. The ArrayUtils.contains method will check if the value is in the given array.

<pre class='brush: java'>
@Test
public void array_contains_element_java_with_apache_commons () {

    int[] vikQueensLosingSeasons = {
            1962, 1967, 1984, 2011, 1966,
            1963, 1982, 2001, 1990, 2002,
            2006, 2010, 1965, 1972, 1979,
            1981, 1985};

    boolean losingSeason = ArrayUtils.contains(vikQueensLosingSeasons, 1962);
    assertTrue(losingSeason);
}
</pre>
---

## 查找数组元素的索引
This example will find the index of a given primitive or object value within an array while using java, guava and apache commons.

### Straight up Java
While using the core jdk we will create an array of Strings and Integers then call Arrays.asList to convert to an arraylist. Next we will call ArrayList.indexOf which will return the index of the first occurrence of the specified element in this list.

#### Object
<pre class='brush: java'>
@Test
public void element_index_in_array_java () {

    String[] lilyFlowers = {
              "Lily of the valley",
              "Lily Elite",
              "Lily Monte Negro",
              "Lily Casa Blanca",
              "Lily of the Nile – Alba",
              "Lily Stargazer"};

    int indexOfFlower = Arrays.asList(lilyFlowers).indexOf("Lily Monte Negro");

    assertEquals(2, indexOfFlower);
}
</pre>

#### Primitive
<pre class='brush: java'>
@Test
public void element_index_in_int_array_java () {

    Integer[] twoQuarters = {1, 2, 3, 4, 5, 6};

    int endOfFirstQuarter = Arrays.asList(twoQuarters).indexOf(3);

    assertEquals(2, endOfFirstQuarter);
}
</pre>

### Google Guava

#### Object
Using guava's Iterators class we will pass a predicate to Iterators.indexOf which will return the index of the first element that satisfies the provided predicate or in this case that matches "Lily Elite".

<pre class='brush: java'>
@Test
public void element_index_in_array_java_with_guava () {

    String[] lilyFlowers = {
              "Lily of the valley",
              "Lily Elite",
              "Lily Monte Negro",
              "Lily Casa Blanca",
              "Lily of the Nile – Alba",
              "Lily Stargazer"};

    int indexOfFlower = Iterators.indexOf(Iterators.forArray(lilyFlowers), new Predicate<String>() {
        public boolean apply(String input) {
            return input.equals("Lily Elite");
        }
    });

    assertEquals(1, indexOfFlower);
}
</pre>

#### Primitive
To find the index of primitive array using guava, we will use Ints class that contains static utility methods pertaining to int primitives. The Ints.indexOf will return the index of the first apperance of the value specified or in this case 3.

<pre class='brush: java'>
@Test
public void element_index_of_ints_in_array_java_with_guava () {

    int [] twoQuarters = {1, 2, 3, 4, 5, 6};

    int lastMonthInFirstQuarter = Ints.indexOf(twoQuarters, 3);
    assertEquals(2, lastMonthInFirstQuarter);
}
</pre>

### Apache Commons
Apache commons ArrayUtils class contains operations on primitive or object arrays. We will ArrayUtils.indexOf which will find the index of the given value in the array.
#### Object

<pre class='brush: java'>
@Test
public void element_index_of_string_array_java_with_apache_commons() {

    String[] lilyFlowers = { "Lily of the valley", "Lily Elite",
            "Lily Monte Negro", "Lily Casa Blanca",
            "Lily of the Nile – Alba", "Lily Stargazer" };

    int indexOfFlower = ArrayUtils.indexOf(lilyFlowers, "Lily Elite");

    assertEquals(1, indexOfFlower);
}
</pre>

#### Primitive
<pre class='brush: java'>
@Test
public void element_index_of_int_array_java_with_apache_commons() {

    int [] twoQuarters = {1, 2, 3, 4, 5, 6};

    int lastMonthInFirstQuarter = ArrayUtils.indexOf(twoQuarters, 3);
    assertEquals(2, lastMonthInFirstQuarter);
}
</pre>
---

## 初始化数组
This java example will demonstrate how to initialize a primitive or object array of specified type and size while using java and guava.

### Straight up Java
Java core library provides two basic ways to initialize an array. First is to create an array with the new operator then assign a value to each element of the array. The second is to use the shortcut syntax to create and initialize an array.

#### Initialize primitive array
<pre class='brush: java'>
@Test
public void initalize_int_array_java () {

    // declares an array of integers
    int[] nflNorthStadiumsCapacity;

    // allocates memory for 4 integers
    nflNorthStadiumsCapacity = new int[4];

    // initialize elements
    nflNorthStadiumsCapacity[0] = 80750;
    nflNorthStadiumsCapacity[1] = 61500;
    nflNorthStadiumsCapacity[2] = 64121;
    nflNorthStadiumsCapacity[3] = 65000;

    assertTrue(nflNorthStadiumsCapacity.length == 4);
}
</pre>

#### Initialize primitive array shortcut
<pre class='brush: java'>
@Test
public void initalize_int_array_java_shortcut () {

    int[] nflNorthStadiumsCapacity = {
            80750, 61500,
            64121, 65000};

    assertTrue(nflNorthStadiumsCapacity.length == 4);
}
</pre>

#### Initialize object array
<pre class='brush: java'>
@Test
public void initialize_string_array_java () {

    // declares an array of strings
    String[] nflNorthStadiums;

    // allocates memory for 4 strings
    nflNorthStadiums = new String[4];

    // initialize elements
    nflNorthStadiums[0] = "Lambeau Field";
    nflNorthStadiums[1] = "Soldier Field";
    nflNorthStadiums[2] = "Mall of America Fielddagger";
    nflNorthStadiums[3] = "Ford Fielddagger";

    assertTrue(nflNorthStadiums.length == 4);
}
</pre>

#### Initialize object array shortcut
<pre class='brush: java'>
@Test
public void initialize_string_array_java_shortcut () {

    // declares an array of strings
    String[] nflNorthStadiums = {
            "Lambeau Field",
            "Soldier Field",
            "Mall of America Fielddagger",
            "Ford Fielddagger"};

    assertTrue(nflNorthStadiums.length == 4);
}
</pre>

### Google Guava
ObjectArrays is a guava utility class that pertains to object arrays. In first example below, we will call the ObjectArrays.newArray method which will return a new array of the specified length and component type. The second example will call the overloaded ObjectArrays.newArray which will return a new array of the the given length and a reference type. In this case returning a String[].

#### Initialize object array
<pre class='brush: java'>
@Test
public void initialize_string_array_java_with_guava () {

    String[] nflNorthStadiums = ObjectArrays.newArray(String.class, 4);

    nflNorthStadiums[0] = "Lambeau Field";
    nflNorthStadiums[1] = "Soldier Field";
    nflNorthStadiums[2] = "Mall of America Fielddagger";
    nflNorthStadiums[3] = "Ford Fielddagger";

    assertTrue(nflNorthStadiums.length == 4);
}
</pre>

#### Initialize object array w/ reference type
<pre class='brush: java'>
@Test
public void initialize_string_array_java_with_guava_reference_type () {

    String[] nflStadiums = {""};

    String[] nflNorthStadiums = ObjectArrays.newArray(nflStadiums, 4);

    nflNorthStadiums[0] = "Lambeau Field";
    nflNorthStadiums[1] = "Soldier Field";
    nflNorthStadiums[2] = "Mall of America Fielddagger";
    nflNorthStadiums[3] = "Ford Fielddagger";

    assertEquals(4, nflNorthStadiums.length);
}
</pre>
---

## 合并两个数组
Similar to joining two arraylists or collections, this example we will demonstrate how to combine the contents of a primitive array and an object array while using java, guava and apache commons. As shown in the setup, we initialize two string arrays that represent the state capitals and two primitive arrays of type int of an arbitrary index. Each example will return an array that will contain the concatenated contents while using a simple junit test case to validate the length of the array.

### Setup
<pre class='brush: java'>
String[] firstHalfStateCapital = {
        "Montgomery",
        "Juneau",
        "Phoenix",
        ...
        "Jackson",
        "Jefferson City" };

String[] secondHalfStateCapital = {
        "Helena",
        "Lincoln",
        ...
        "Madison",
        "Cheyenne" };

int[] firstHalfStateCapitalByIndex = {
        1,
        2,
        3,
        ...
        23,
        24,
        25
};

int[] secondHalfStateCapitalByIndex = {
        26,
        27,
        28,
        ...
        48,
        49,
        50
};
</pre>

### Straight up Java
<pre class='brush: java'>
@Test
public void join_two_object_arrays_in_java () {

    String[] allStateCapitals = new String[firstHalfStateCapital.length + secondHalfStateCapital.length];

    // copy first half
    System.arraycopy(firstHalfStateCapital, 0, allStateCapitals, 0, firstHalfStateCapital.length);

    // copy second half
    System.arraycopy(secondHalfStateCapital, 0, allStateCapitals, firstHalfStateCapital.length, secondHalfStateCapital.length);

    assertTrue(allStateCapitals.length == 50);
}
</pre>

### Google Guava
Two guava utility classes, ObjectArrays handles object arrays and Ints pertain to int primitives, contain series of static methods for dealing with respective types.

#### Join object arrays
<pre class='brush: java'>
@Test
public void join_two_object_arrays_in_java_with_guava () {

    String[] allStateCapitals = ObjectArrays.concat(firstHalfStateCapital, secondHalfStateCapital, String.class);

    assertTrue(allStateCapitals.length == 50);
}
</pre>

#### Join primitive arrays
<pre class='brush: java'>
@Test
public void join_two_primitive_arrays_in_java_with_guava () {

    int[] allStateCapitalsByIndex = Ints.concat(firstHalfStateCapitalByIndex, secondHalfStateCapitalByIndex);

    Arrays.toString(allStateCapitalsByIndex);
    assertEquals(50, allStateCapitalsByIndex.length);
}
</pre>

### Apache Commons
Apache commons contains a class ArrayUtils that contain operations on arrays, primitive arrays and primitive wrapper arrays.

#### Join object arrays
<pre class='brush: java'>
@Test
public void join_two_object_arrays_in_java_with_apache_commons () {

    String[] allStateCapitals = ArrayUtils.addAll(firstHalfStateCapital, secondHalfStateCapital);

    assertEquals(50, allStateCapitals.length);
}
</pre>

#### Join primitive arrays
<pre class='brush: java'>
@Test
public void join_two_primitive_arrays_in_java_with_apache_commons () {

    int[] allStateCapitalsByIndex = ArrayUtils.addAll(firstHalfStateCapitalByIndex, secondHalfStateCapitalByIndex);

    assertEquals(50, allStateCapitalsByIndex.length);

}
</pre>
---

原文:[http://www.leveluplunch.com/java/examples](http://www.leveluplunch.com/java/examples#java-array) posted by ```Justin Musgrove``` on 29 January 2014